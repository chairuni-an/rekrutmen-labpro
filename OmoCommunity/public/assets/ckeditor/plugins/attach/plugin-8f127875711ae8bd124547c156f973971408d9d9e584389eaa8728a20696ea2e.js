attachmentUploader={uploadButton:null,editor:null,uploadEventBinded:!1,uploadingContainer:null,statusMessageContainer:null,uploadingSource:CKEDITOR.plugins.getPath("attach")+"uploading.gif",autoClose:!1,validateSize:0,setStatusMessageContainer:function(t){this.statusMessageContainer=t.getElement()},setUploadingContainer:function(t){this.uploadingContainer=t.getElement()},setuploadButton:function(t){this.uploadButton=$(t.getInputElement().$.children[0])},getFileField:function(){return $($("body").find("iframe.cke_dialog_ui_input_file:visible").contents().find('input[type="file"]'))},getResultantHTML:function(){return $($("body").find("iframe.cke_dialog_ui_input_file:visible").contents().find("body")).html()},bindUploadEvent:function(){var t=function(){"Uploading.."==attachmentUploader.uploadButton.text()&&(attachmentUploader.editor.config.onAttachmentUpload&&attachmentUploader.editor.config.onAttachmentUpload(attachmentUploader.getResultantHTML()),attachmentUploader.uploadButton.text("Uploaded"),attachmentUploader.statusMessageContainer.setText("File Upload Successful!!"),attachmentUploader.statusMessageContainer.show(),attachmentUploader.uploadingContainer.hide(),attachmentUploader.autoClose&&CKEDITOR.dialog.getCurrent().hide())};$("body").find("iframe.cke_dialog_ui_input_file").load(t),attachmentUploader.uploadEventBinded=!0}},CKEDITOR.dialog.add("abbrDialog",function(t){return{title:"Upload Attachments",minWidth:400,minHeight:200,contents:[{id:"Upload",filebrowser:"uploadButton",hidden:!0,elements:[{type:"html",html:"Please upload a single file, zip and upload multiple files if required"},{type:"file",id:"attachment",inputStyle:"outline: 0",style:"height:40px",size:38},{type:"fileButton",id:"uploadButton",filebrowser:"info:txtUrl",label:t.lang.image.btnUpload,"for":["Upload","attachment"],onClick:function(){var t=attachmentUploader.getFileField();t.val()?attachmentUploader.validateSize>0&&t[0].files[0].size>1e6*attachmentUploader.validateSize?(alert("File Size Limit is "+attachmentUploader.validateSize+"mb"),t.val("")):(attachmentUploader.uploadButton.text("Uploading..").parent("a").hide(),attachmentUploader.uploadingContainer.show()):alert("Please select a file first")},onLoad:function(){attachmentUploader.setuploadButton(this)}},{type:"html",html:'<img class="uploading-img" src="'+attachmentUploader.uploadingSource+'"></img',style:"margin-left:35%",hidden:!0,onLoad:function(){attachmentUploader.setUploadingContainer(this)}},{type:"html",html:'<div class="status-message"></div>',style:"margin-left:32%;  color: green",hidden:!0,onLoad:function(){attachmentUploader.setStatusMessageContainer(this)}}]}],onOk:function(t){"Uploaded"!=attachmentUploader.uploadButton.text()&&(confirm("Please make sure you send files to server or else upload will be cancelled!!")||t.preventDefault())},onShow:function(){attachmentUploader.getFileField().css("outline",0);$("body").find("iframe.cke_dialog_ui_input_file").css("height","36px"),attachmentUploader.uploadButton&&attachmentUploader.uploadButton.text("Upload attachment").parent("a").show(),attachmentUploader.uploadEventBinded||attachmentUploader.bindUploadEvent(),attachmentUploader.statusMessageContainer.setText(""),attachmentUploader.statusMessageContainer.hide(),attachmentUploader.autoClose=attachmentUploader.editor.config.autoCloseUpload||!1,attachmentUploader.validateSize=attachmentUploader.editor.config.validateSize||0}}}),CKEDITOR.plugins.add("attach",{init:function(t){attachmentUploader.editor=t;t.ui.addButton("Attachments",{label:"Attach files",command:"OpenWindow",icon:CKEDITOR.plugins.getPath("attach")+"attach.png"});t.addCommand("OpenWindow",new CKEDITOR.dialogCommand("abbrDialog"))}});